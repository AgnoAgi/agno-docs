---
title: Structured Output
---

One of our favorite LLM features is generating structured data (i.e. a pydantic model) from text. Use this feature to extract features, generate movie scripts, produce fake data etc.

## Example

Let's create an Movie Agent to write a `MovieScript` for us.

```python movie_agent.py
from typing import List
from rich.pretty import pprint  # noqa
from pydantic import BaseModel, Field
from phi.agent import Agent, RunResponse  # noqa
from phi.model.openai import OpenAIChat


class MovieScript(BaseModel):
    setting: str = Field(..., description="Provide a nice setting for a blockbuster movie.")
    ending: str = Field(..., description="Ending of the movie. If not available, provide a happy ending.")
    genre: str = Field(
        ..., description="Genre of the movie. If not available, select action, thriller or romantic comedy."
    )
    name: str = Field(..., description="Give a name to this movie")
    characters: List[str] = Field(..., description="Name of characters for this movie.")
    storyline: str = Field(..., description="3 sentence storyline for the movie. Make it exciting!")


# Agent that uses JSON mode
# Available to most LLM providers
json_mode_agent = Agent(
    model=OpenAIChat(id="gpt-4o"),
    description="You write movie scripts.",
    response_model=MovieScript,
)

# Agent that uses structured outputs
# Only available to certain OpenAI models
structured_output_agent = Agent(
    model=OpenAIChat(id="gpt-4o-2024-08-06"),
    description="You write movie scripts.",
    response_model=MovieScript,
    structured_outputs=True,
)


# Get the response in a variable
json_mode_response: RunResponse = json_mode_agent.run("New York")
pprint(json_mode_response.content)
structured_output_response: RunResponse = structured_output_agent.run("New York")
pprint(structured_output_response.content)
```

The output is a pydantic object of the `MovieScript` class, here's how it looks:

```python
# json_mode_response
MovieScript(
│   setting='The bustling streets and hidden alleyways of New York City, from the glitzy towers of Manhattan to the vibrant neighborhoods of Brooklyn.',
│   ending='The protagonists uncover a conspiracy, triumph over adversity, and bring the villains to justice, leading to a major city celebration.',
│   genre='Thriller',
│   name='Echoes of the Concrete Jungle',
│   characters=['Jack Harper', 'Elena Ramirez', 'Detective Marcus Lee', 'Vivian Monroe', 'Leo Carver'],
│   storyline="When journalist Elena Ramirez stumbles upon a mysterious signal causing chaos throughout New York City, she teams up with tech-savvy detective Marcus Lee to investigate. As they delve deeper into the city's underbelly, they uncover a sinister plot orchestrated by a powerful corporation led by the enigmatic Vivian Monroe. Racing against time to prevent disaster, they harness the skills of reformed hacker Leo Carver and courageous taxi driver Jack Harper to save the city and its inhabitants."
)
```

```python
# json_mode_response
MovieScript(
│   setting='Set against the fast-paced backdrop of New York City, this movie takes place among the iconic skyscrapers and bustling streets of Manhattan.',
│   ending='In a heart-stopping climax atop the Brooklyn Bridge, Justice manages to outsmart the villains and save the city from sabotage. Harmony, choosing love over vendetta, helps him foiling the plot, and they both embrace, knowing they have prevented a catastrophe. Under the shimmering city lights, they realize their true feelings for each other, promising to face whatever the future holds together.',
│   genre='Action Thriller',
│   name='Manhattan Meltdown',
│   characters=['Detective Jack Justice', 'Harmony Black', 'Anthony Delgado', 'Sophia Marquez'],
│   storyline="Detective Jack Justice has 24 hours to thwart a massive terrorist attack on New York City orchestrated by an elusive mastermind. With the help of the enigmatic cat burglar Harmony Black, Jack races against the clock through iconic NYC landmarks. As the pair discovers a personal connection between the attack and Jack's past, every minute brings them closer to betrayal or redemption."
)
```
