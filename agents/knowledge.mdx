---
title: Knowledge
---

Knowledge Base is a database of information that the Agent can search to improve its responses. This information is stored in a vector database and provides LLMs with business context, which makes them respond in a context-aware manner. The general syntax is:

```python
from phi.agent import Agent, AgentKnowledge

# Create knowledge base
knowledge_base = AgentKnowledge(vector_db=...)

# Add information to the knowledge base
knowledge_base.load_text("The sky is blue")

# Add the knowledge base to the Agent
agent = Agent(knowledge_base=knowledge_base)
```

## Vector Databases

While any type of storage can act as a knowledge base, vector databases offer the best solution for retrieving relevant results from dense information quickly.

**Our goal is to search relevant information from a knowledge base quickly**, here's how vector databases are used with LLMs:

<Steps>
  <Step title="Chunk the information">
    Break down the knowledge into smaller chunks to ensure our search query matches only relevant results.
  </Step>
  <Step title="Load the knowledge base">
    Convert the chunks into embedding vectors and store them in a vector database.
  </Step>
  <Step title="Search the knowledge base">
    When the user sends a message, we convert the input message into an embedding and "search" for nearest neighbors in the vector database.
  </Step>
</Steps>

## Example: Agent with a PDF Knowledge Base

Let's build an **Agent** that answers questions from a PDF.

1. We'll load our knowledge base with the PDF of a recipe book.
2. Our **Agent** will respond with recipes from the knowledge base.

### Step 1: Run PgVector

Let's use `PgVector` as our vector db as it can also provide storage for our Agents.

Install [docker desktop](https://docs.docker.com/desktop/install/mac-install/) and run **PgVector** on port **5532** using:

```bash
docker run -d \
  -e POSTGRES_DB=ai \
  -e POSTGRES_USER=ai \
  -e POSTGRES_PASSWORD=ai \
  -e PGDATA=/var/lib/postgresql/data/pgdata \
  -v pgvolume:/var/lib/postgresql/data \
  -p 5532:5432 \
  --name pgvector \
  phidata/pgvector:16
```

### Step 2: RAG Agent with Hybrid Search

Retrieval Augmented Generation means **"stuffing the prompt with relevant information"** to improve LLM responses. This is a 2 step process:
1. Retrieve relevant information from a vector database using a mixture of semantic and keyword search.
2. Augment the prompt to provide context to the LLM.

Let's build a **PDF Agent** that helps us with food recipes using RAG.

<Steps>
  <Step title="Install libraries">
    Install the required libraries using pip

    <CodeGroup>

    ```bash Mac
    pip install -U pgvector pypdf "psycopg[binary]" sqlalchemy
    ```

    ```bash Windows
    pip install -U pgvector pypdf "psycopg[binary]" sqlalchemy
    ```

    </CodeGroup>

  </Step>
  <Step title="Create a RAG Agent">
    Create a file `rag_agent.py` with the following contents

    ```python rag_agent.py
    from phi.agent import Agent
    from phi.knowledge.pdf import PDFUrlKnowledgeBase
    from phi.vectordb.pgvector import PgVector, SearchType

    db_url = "postgresql+psycopg://ai:ai@localhost:5532/ai"
    knowledge_base = PDFUrlKnowledgeBase(
        urls=["https://phi-public.s3.amazonaws.com/recipes/ThaiRecipes.pdf"],
        vector_db=PgVector(table_name="recipes", db_url=db_url, search_type=SearchType.hybrid),
    )

    # Load the knowledge base
    knowledge_base.load(recreate=False)

    agent = Agent(
        knowledge=knowledge_base,
    )
    agent.print_response("How do I make pad thai?", markdown=True)
    ```

  </Step>
  <Step title="Run the Agent">
    Run the Agent (it takes a few seconds to load the knowledge base).

    <CodeGroup>

    ```bash Mac
    python rag_agent.py
    ```

    ```bash Windows
    python rag_agent.py
    ```

    </CodeGroup>

    <br />

    <Note>
    The Agent uses the `OpenAI` LLM and Embeddings by default.
    </Note>

  </Step>
</Steps>

<Accordion title="How to use local PDFs" icon="file-pdf" iconType="duotone">
If you want to use local PDFs, use a `PDFKnowledgeBase` instead

```python agent.py
from phi.knowledge.pdf import PDFKnowledgeBase

...
knowledge_base = PDFKnowledgeBase(
    path="data/pdfs",
    vector_db=PgVector(
        collection="pdf_documents",
        db_url=vector_db.get_db_connection_local(),
    ),
)
...
```

</Accordion>
